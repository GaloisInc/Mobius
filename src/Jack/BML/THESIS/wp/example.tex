\subsection{Example}
\subsection{Example}

%\subsubsection{Weakest Precondition in the Presence of Loop }
The following example shows how the weakest precondition calculus is applied to the example program for which we have shown the source code at Fig. \ref{replaceSrc} and
 its bytecode control flow graph at Fig. \ref{ctrlflow}. 
In particular, the example that comes here after 
gives the weakest preconditions  for the instructions that are part  of the loop of the method body. 
Thus, every instruction is preceded with its weakest precondition enclosed in curly braces.
The invariant is written at the place where it must hold (i.e. where the backedge relating the loop entry and the loop end is). The weakest precondition of every instruction is calculated w.r.t.
 the weakest precondition of the next instruction in the execution path. So,
 looking at the example, the precondition of instruction $19$ is calculated w.r.t. the loop 
invariant.  The weakest precondition of the instruction $18$ is calculated w.r.t. the wp of instruction $19$ etc. Also the wp of the jump instruction $24$ is calculated from the weakest 
precondition of instruction $6$. 
This example shows the process of calculating the verification conditions for a program. 

 The wp of a method body is the conjunction the wps  of all of its execution paths. 

$$
\begin{array}{l}
 % \tt{ 1 \ iconst\_0 } \\

 % \tt{ 2 \ istore\_3 } \\

 % \tt{ 3 \ iconst\_0 } \\

 % \tt{ 4 \ istore\_3 } \\



 % \tt{ 5 \ goto \ 20 } \\

\ldots \\

\\
  \{ \\
 \locVar{0} = \Mynull \Rightarrow \false  \wedge\\ 
 \locVar{0} \neq \Mynull \Rightarrow \\
 \Myspace 	test.ListArray.list(\locVar{0} ) \neq \Mynull \wedge \\ 
 \Myspace 	len(test.ListArray.list(\locVar{0} ) ) > \locVar{3} \wedge \\ 
 \Myspace 	\locVar{3} \geq 0 \wedge \\   
 \Myspace 	\locVar{1} \neq ListArray.list(\locVar{0})[\locVar{3} ]  \Rightarrow  \\ 
 \Myspace \Myspace     1 + \locVar{3}  \leq len(test.ListArray.list(\locVar{0}))  \wedge \\
 \Myspace \Myspace     1 + \locVar{3}  \geq 0 \wedge \\ 
 \Myspace \Myspace   \forall  var(0).   0 \leq var(0) \wedge var(0) < 1 + \locVar{3}   \Rightarrow  \\ 		             
 \Myspace \Myspace \Myspace  ListArray.list(\locVar{0} )[var(0)] \neq \locVar{1}        \\
		\wedge \\
ListArray.list(\locVar{0} ) = \Mynull  \Rightarrow  \false   \wedge \\
  len(test.ListArray.list(\locVar{0})) \le \locVar{3} \vee \locVar{3} < 0 \Rightarrow  \false  \\
\}  \\
\bf{ 6 \ aload\_0 }\\
\\


  \{ \\
\stack{\counter} =  \Mynull \Rightarrow \false  \wedge \\ 
 \stack{ \counter} \neq \Mynull \Rightarrow \\
 \Myspace 	ListArray.list(\stack{\counter}) \neq \Mynull  \wedge \\ 
 \Myspace        len(test.ListArray.list(\stack{\counter})) > \locVar{3} \wedge  \\
 \Myspace 	\locVar{3} >= 0   \wedge \\
 \Myspace 	\locVar{1} \neq ListArray.list(\stack{\counter})[\locVar{3}]   \Rightarrow \\
 \Myspace \Myspace 	1 + \locVar{3} <= len(test.ListArray.list(\locVar{0})) \wedge \\
 \Myspace \Myspace 	1 + \locVar{3} >= 0  \wedge \\
 \Myspace \Myspace 	\forall  var(0). \  0 \leq var(0) \wedge var(0) < 1 + \locVar{3}  \Rightarrow \\
 \Myspace \Myspace \Myspace ListArray.list(\locVar{0})[var(0)] \neq \locVar{1}   \wedge \\
ListArray.list(\stack{\counter}) = \Mynull \Rightarrow \false   \wedge \\
  len(test.ListArray.list(\stack{\counter})) <= \locVar{3} \vee \locVar{3} < 0  \Rightarrow \false \\
\}  \\
\bf{ 7 \ getfield \ ListArray.list} \\

\end{array}$$
$$
\begin{array}{l}
\\
\{ \\
 \stack{\counter} \neq \Mynull \wedge \\ 
 len(\stack{\counter}) > \locVar{3} \wedge \\
 \locVar{3} \geq 0 \wedge \\
 \locVar{1} \neq \stack{\counter}[\locVar{3}]  \Rightarrow \\
 \Myspace 	1 + \locVar{3} \leq len(ListArray.list(\locVar{0})) \wedge \\
 \Myspace 		1 + \locVar{3} >= 0  \wedge \\
 \Myspace 		\forall  var(0)  . 0 <= var(0) \wedge (var(0) < 1 + \locVar{3} \Rightarrow \\
 \Myspace   \Myspace  ListArray.list(\locVar{0})[var(0)] \neq \locVar{1}   \wedge \\
 \stack{\counter} = \Mynull) \Rightarrow \false \wedge \\
  len(\stack{\counter}) \leq \locVar{3} \vee \locVar{3} < 0  \Rightarrow \false  \\
\}\\ 
\bf{ 8 \ iload\_3} \\




\\
\{ \\
 \stack{\counter - 1} \neq \Mynull \wedge \\ 
   len(\stack{\counter - 1} > \stack{\counter}  \wedge \\ 
   \stack{\counter} \geq 0  ) \wedge \\
     \locVar{1} \neq \stack{\counter - 1}[\stack{\counter}] \Rightarrow \\ 
  \Myspace                1 + \locVar{3} \leq len(test.ListArray.list(\locVar{0})) \wedge \\ 
\Myspace 		 1 + \locVar{3} \geq 0  \wedge \\
\Myspace 		 \forall  var(0). \   0 \leq var(0) \wedge var(0) < 1 + \locVar{3}  \Rightarrow \\ 
		\Myspace 	\Myspace \Myspace 	 ListArray.list(\locVar{0})[var(0)] \neq \locVar{1}  \wedge \\ 
\stack{\counter - 1} = \Mynull) \Rightarrow \false   \wedge  \\
len(\stack{\counter - 1}) \leq \stack{\counter} \vee \stack{\counter} < 0 \Rightarrow \false \\  
\}\\ 
\bf{ 9 \ aaload} \\


\\
\{ \\ 
  \locVar{1} \neq \stack{\counter} \Rightarrow  \\
 \Myspace   1 + \locVar{3} \leq len(test.ListArray.list(\locVar{0}) \wedge \\ 
 \Myspace  1 + \locVar{3} \geq 0 \wedge \\ 
  \Myspace \forall  var(0)  . \   0 \leq var(0) \wedge var(0) < 1 + \locVar{3}  \Rightarrow  ListArray.list(\locVar{0})[var(0)] \neq \locVar{1}  \\ 
\} \\
 
\bf{10 \ aload\_1} \\ 

\\
\{ \\
\stack{\counter} \neq \stack{\counter -1} \Rightarrow \\ 
\Myspace  1 + \locVar{3} \leq len(test.ListArray.list(\locVar{0})) \wedge \\
\Myspace  1 + \locVar{3} \geq 0 \wedge  \\
\Myspace  \forall  var(0). \ 0 \leq var(0) \wedge var(0) < 1 + \locVar{3} \Rightarrow   \\
 \Myspace \Myspace   ListArray.list(\locVar{0})[var(0)] \neq \locVar{1} \\
\} \\
 \bf{11 \ if\_acmpne 19 } \\
 
\end{array}$$

$$
\begin{array}{l}
\ldots \\ 
% 12 \ aload\_0 \\
% 13 \ getfieldListArray.list \\
% 14 \ iload\_3 \\
% 15 \ aload\_2 \\
% 16 \ aastore \\
% 17 \ iconst\_1
% 18 \ ireturn \\
\ldots \\
\\
\{ \\
   1 + \locVar{3} \leq len(test.ListArray.list(\locVar{0}))) \wedge \\
   1 + \locVar{3} \geq 0 \wedge  \\
\forall  var(0). \ 0 \leq var(0) \wedge var(0) < 1 + \locVar{3} \Rightarrow   \\
\Myspace ListArray.list(\locVar{0})[var(0)] \neq \locVar{1}   \\
\} \\

\bf{ 19 \ iinc  \ 3  } \\

\\
\{ \\
\bf{invariant :}\\ 
   \locVar{3} \leq len(test.ListArray.list(\locVar{0})) \wedge \\
   \locVar{3} \geq 0 \wedge  \\
\forall  var(0). \ 0 \leq var(0) \wedge var(0) < \locVar{3} \Rightarrow   \\
\Myspace ListArray.list(\locVar{0})[var(0)] \neq \locVar{1}   \\
\} \\


\\

\{ \\
 \forall  var(27). \   var(27) \neq \locVar(0)  \wedge \\ 
 \forall  var(26) .\ var(26) \geq 0 \wedge var(26) < len(test.ListArray.list(var(27)) \Rightarrow \\ 
 \Myspace ListArray.list(var(27))[var(26)] =ListArray.list\_at\_20(var(27))[var(26)]  \wedge \\ 
 \Myspace \locVar{3}\_at\_20 \leq len(ListArray.list\_at\_20(\locVar{0})) \wedge \\ 
 \Myspace \locVar{3}\_at\_20 \geq 0  \wedge \\ 
 \Myspace \forall  var(0). \  0 \leq var(0) \wedge var(0) < \locVar{3}\_at\_20  \Rightarrow \\ 
\Myspace \Myspace ListArray.list\_at\_20(\locVar{0})[var(0)] \neq \locVar{1} 

\\    \Rightarrow \\ 

 \Myspace  \locVar{0} = \Mynull \Rightarrow \Myfalse  \wedge\\
 \Myspace  \locVar{0} \neq \Mynull \Rightarrow \\ 
 \Myspace  \Myspace ListArray.list\_at\_20(\locVar{0}) \neq \Mynull \wedge \\ 
 \Myspace  \Myspace  \locVar{3}\_at\_20) < len( ListArray.list\_at\_20(\locVar{0})) \Rightarrow \\ 
 \Myspace  \Myspace \Myspace  \locVar{0} = \Mynull \Rightarrow \Myfalse  \wedge \\ 
 \Myspace  \Myspace \Myspace  \locVar{0} \neq \Mynull \Rightarrow  \\
  \Myspace  \Myspace \Myspace \Myspace ListArray.list\_at\_20(\locVar{0}) \neq \Mynull \wedge \\ 
  \Myspace  \Myspace \Myspace \Myspace len(ListArray.list\_at\_20(\locVar{0}))
 > \locVar{3}\_at\_20 \wedge \\
\Myspace  \Myspace \Myspace \Myspace  \locVar{3}\_at\_20 \geq 0   \wedge \\ 
\Myspace  \Myspace \Myspace \Myspace  \locVar{1} \neq ListArray.list\_at\_20(\locVar{0})[\locVar{3}\_at\_20]  \Rightarrow \\ 
\Myspace  \Myspace \Myspace \Myspace \Myspace  1 + \locVar{3}\_at\_20 \leq 
len(test.ListArray.list\_at\_20(\locVar{0})) \wedge \\ 
\Myspace  \Myspace \Myspace \Myspace \Myspace 1 + \locVar{3}\_at\_20 \geq 0  \wedge \\ 
\Myspace  \Myspace \Myspace \Myspace \Myspace \forall  var(0) . 0 \leq var(0)) \wedge  var(0) < 1 + \locVar{3}\_at\_20  \Rightarrow \\ 
\Myspace  \Myspace \Myspace \Myspace \Myspace \Myspace ListArray.list\_at\_20)(\locVar{0})[var(0)] \neq \locVar{1}  \wedge \\  
\Myspace  \Myspace \Myspace \Myspace \Myspace
 ListArray.list\_at\_20(\locVar{0}) = \Mynull \Rightarrow \Myfalse  \wedge \\ 
\Myspace  \Myspace \Myspace \Myspace \Myspace len(test.ListArray.list\_at\_20)(\locVar{0}) \leq \locVar{3}\_at\_20 \vee \locVar{3}\_at\_20 < 0 \Rightarrow \Myfalse ) ) \\ 
\} \\
\bf{20 \ aload\_3} \\



\end{array}
$$

$$
\begin{array}{l}
\{\\
  \locVar{0} = \Mynull \Rightarrow \Myfalse  \wedge \\
  \locVar{0} \neq \Mynull \Rightarrow \\ 
  \Myspace ListArray.list(\locVar{0}) \neq \Mynull \wedge \\ 
  \Myspace \stack{\counter - 1} < len(test.ListArray.list(\locVar{0})  \Rightarrow \\  
  \Myspace \locVar{0} = \Mynull \Rightarrow  \Myfalse  \wedge \\ 
  \Myspace \locVar{0} \neq  \Mynull \Rightarrow \\  
  \Myspace \Myspace  ListArray.list(\locVar{0}) \neq \Mynull \wedge \\ 
  \Myspace \Myspace  len(test.ListArray.list(\locVar{0})) > \locVar{3} \wedge \\ 
  \Myspace \Myspace \locVar{3} \geq 0  ) \wedge \\ 
  \Myspace \Myspace \locVar{1} \neq  ListArray.list(\locVar{0})[\locVar{3}] \Rightarrow \\  
  \Myspace \Myspace \Myspace  1 + \locVar{3} \leq len(test.ListArray.list(\locVar{0})) \wedge \\ 
  \Myspace \Myspace \Myspace  1 + \locVar{3} \geq 0  \wedge \\ 
  \Myspace \Myspace \Myspace \forall  var(0). \ 0 \leq var(0) \wedge var(0) < 1 + \locVar{3}  \Rightarrow \\  
   \Myspace \Myspace \Myspace \Myspace ListArray.list(\locVar{0})[var(0)] \neq \locVar{1} ) ) ) \wedge \\ 
 \Myspace ListArray.list(\locVar{0}) = \Mynull \Rightarrow  \Myfalse  \wedge \\ 
 \Myspace len(test.ListArray.list(\locVar{0})) \leq \locVar{3}) \vee (\locVar{3} < 0)  \Rightarrow  \Myfalse ) )  \wedge \\ 
 \Myspace ListArray.list(\locVar{0}) = \Mynull) \Rightarrow  \Myfalse  \\
\} \\

 \bf{21 \ aload\_0} \\

 \\

\{\\
  \stack{\counter} = \Mynull \Rightarrow \Myfalse  \wedge \\
  \stack{\counter} \neq \Mynull \Rightarrow \\ 
  \Myspace ListArray.list(\stack{\counter}) \neq \Mynull \wedge \\ 
  \Myspace \stack{\counter - 1} < len(test.ListArray.list(\stack{\counter})  \Rightarrow \\  
  \Myspace \locVar{0} = \Mynull \Rightarrow  \Myfalse  \wedge \\ 
  \Myspace \locVar{0} \neq  \Mynull \Rightarrow \\  
  \Myspace \Myspace  ListArray.list(\locVar{0}) \neq \Mynull \wedge \\ 
  \Myspace \Myspace  len(test.ListArray.list(\locVar{0})) > \locVar{3} \wedge \\ 
  \Myspace \Myspace \locVar{3} \geq 0  ) \wedge \\ 
  \Myspace \Myspace \locVar{1} \neq  ListArray.list(\locVar{0})[\locVar{3}] \Rightarrow \\  
  \Myspace \Myspace \Myspace  1 + \locVar{3} \leq len(test.ListArray.list(\locVar{0})) \wedge \\ 
  \Myspace \Myspace \Myspace  1 + \locVar{3} \geq 0  \wedge \\ 
  \Myspace \Myspace \Myspace \forall  var(0). \ ( ( (0 \leq var(0)) \wedge (var(0) < (1 + \locVar{3})) ) \Rightarrow \\  
   \Myspace \Myspace \Myspace \Myspace ListArray.list(\locVar{0})[var(0)] \neq \locVar{1} ) ) ) \wedge \\ 
 \Myspace ListArray.list(\locVar{0}) = \Mynull \Rightarrow  \Myfalse  \wedge \\ 
 \Myspace len(test.ListArray.list(\locVar{0})) \leq \locVar{3}) \vee (\locVar{3} < 0)  \Rightarrow  \Myfalse ) )  \wedge \\ 
 \Myspace ListArray.list(\stack{\counter}) = \Mynull) \Rightarrow  \Myfalse  \\
\} \\
\bf{22 \ getfield \ ListArray.list} \\


\end{array}
$$

$$
\begin{array}{l}
\{ \\
\stack{\counter} = \Mynull \Rightarrow \Myfalse \\
 \stack{\counter} \neq \Mynull  \wedge \\ 
 \stack{\counter - 1} < len(\stack{\counter}) \Rightarrow \\
 \Myspace  \locVar{0} = \Mynull \Rightarrow \Myfalse  \wedge \\ 
 \Myspace  \locVar{0} \neq \Mynull  \Rightarrow  \\
 \Myspace  \Myspace  ListArray.list(\locVar{0}) \neq \Mynull \wedge \\ 
 \Myspace  \Myspace  len(test.ListArray.list(\locVar{0})) > \locVar{3} \wedge \\
 \Myspace  \Myspace  \locVar{3} \geq  0  \wedge \\
 \Myspace  \Myspace  \locVar{1} \neq ListArray.list(\locVar{0}[\locVar{3}] )  \Rightarrow \\ 
 \Myspace  \Myspace \Myspace  1 + \locVar{3} \leq len(test.ListArray.list(\locVar{0})) \wedge \\ 
 \Myspace  \Myspace \Myspace  1 + \locVar{3} \geq 0  \wedge  \\
 \Myspace  \Myspace \Myspace  \forall  var(0). \  0 \leq var(0) \wedge var(0) < 1 + \locVar{3}  \Rightarrow \\
 \Myspace  \Myspace \Myspace \Myspace ListArray.list(\locVar{0})[var(0)] \neq \locVar{1}   )  ) ) \wedge \\ 
 \Myspace  ListArray.list(\locVar{0}) = \Mynull) \Rightarrow \Myfalse  \wedge  \\
 \Myspace  len(test.ListArray.list(\locVar{0})) \leq \locVar{3}) \vee \locVar{3} < 0 \Rightarrow \Myfalse \\
\} \\ 
\bf{23 \ arraylength} \\

\\

\{ \\
 \stack{\counter - 1} < \stack{\counter} \Rightarrow \\
 \Myspace  \locVar{0} = \Mynull \Rightarrow \Myfalse  \wedge \\ 
 \Myspace  \locVar{0} \neq \Mynull  \Rightarrow  \\
 \Myspace  \Myspace   ListArray.list(\locVar{0}) \neq \Mynull \wedge \\ 
 \Myspace  \Myspace   len(test.ListArray.list(\locVar{0})) > \locVar{3} \wedge \\
 \Myspace  \Myspace   \locVar{3} \geq  0  \wedge \\
 \Myspace  \Myspace    \locVar{1} \neq ListArray.list(\locVar{0}[\locVar{3}] )  \Rightarrow \\ 
 \Myspace  \Myspace \Myspace  1 + \locVar{3} \leq len(test.ListArray.list(\locVar{0})) \wedge \\ 
 \Myspace  \Myspace \Myspace  1 + \locVar{3} \geq 0  \wedge  \\
 \Myspace  \Myspace \Myspace  \forall  var(0). \  0 \leq var(0) \wedge var(0) < 1 + \locVar{3}  \Rightarrow \\
 \Myspace  \Myspace \Myspace \Myspace ListArray.list(\locVar{0})[var(0)] \neq \locVar{1}   )  ) ) \wedge \\ 
 \Myspace  ListArray.list(\locVar{0}) = \Mynull) \Rightarrow \Myfalse  \wedge  \\
 \Myspace  len(ListArray.list(\locVar{0})) \leq \locVar{3}) \vee \locVar{3} < 0 \Rightarrow \Myfalse \\
\} \\
 \bf{24 \  if\_icmplt 6 }\\



\end{array}$$

